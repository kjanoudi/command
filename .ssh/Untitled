SELECT * FROM crosstab('SELECT subject_uuid, first_name , last_name , feature, value FROM core_signal INNER JOIN core_subject ON (core_signal.subject_uuid = core_subject.uuid) ORDER BY 1,2', $$VALUES ('hemoglobin'::text), ('admission'::text), ('discharge'::text)$$) AS final_result ("subject_uuid" uuid, "first_name" text, "last_name" text, "hemoglobin" text, "admission" timestamp, "discharge" timestamp) WHERE hemoglobin IS NOT null AND admission IS NOT null AND hemoglobin::numeric > 10;